# Golang Plugin 版本切换示例

这个示例演示了如何在 Go 程序运行过程中动态切换不同版本的插件。

## 目录结构

```
plugin_version_switch/
├── plugin/            # 插件目录
│   ├── v1.go          # 插件版本1
│   ├── v2.go          # 插件版本2
│   └── v3.go          # 插件版本3
├── app/               # 主程序目录
│   └── main.go        # 能动态切换插件版本的主程序
├── build.sh           # 编译脚本
└── README.md          # 本文件
```

## 功能说明

1. 此示例包含三个版本的插件，每个插件提供：
   - `Version()` 函数 - 返回版本字符串
   - `GetInfo()` 函数 - 返回包含版本详细信息的映射

2. 主程序允许用户在运行时通过命令动态切换不同版本的插件

## 关键技术点

- 每个版本的插件都被编译为单独的 .so 文件
- 主程序每次都重新加载请求的插件版本
- 展示了动态切换不同实现的可能性
- 测量并显示插件加载时间

## 运行方法

```bash
# 编译所有版本的插件和主程序
./build.sh

# 运行主程序
cd app
./app
```

运行后，可以使用以下命令：
- `load v1` - 加载版本1的插件
- `load v2` - 加载版本2的插件
- `load v3` - 加载版本3的插件
- `exit` - 退出程序

## 注意事项

1. 这个示例每次都重新加载插件，在实际应用中可能需要考虑缓存机制
2. Go 的 plugin 机制不支持卸载插件，所以内存使用会随着加载的插件增加
3. 所有插件必须由相同的 Go 版本编译
4. 这个示例只适用于 Linux、macOS 和 FreeBSD，Windows 不支持 Go 的 plugin 功能
